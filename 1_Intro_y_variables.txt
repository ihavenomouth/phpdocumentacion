Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2022-10-04T19:14:14+02:00

====== Introducci칩n y variables ======



===== Introducci칩n al entorno de desarrollo =====

En la m치quina virtual (El usuario es ''usuario'' y la clave es ''Kilobyte1'') la imagen docker preinstalada es ''php:apache'' que incluye la versi칩n 8.1 de PHP. 
Tambi칠n se ha instalado el VS Code.

Para arrancar una imagen oficial de PHP que ya viene con el servidor web instalado.
''docker run -d -p 80:80 --name nombreAppWeb -v "$PWD":/var/www/html php:8.1-apache''



==== Hacer que se nos muestre el contenido del directorio actual ====

Esta parte **es opcional**, simplemente es una muestra de c칩mo podemos cambiar la configuraci칩n del apache dentro del contenedor, de hecho es posible que no sea recomendable para evitar problemas de seguridad.

Por defecto no se nos mostrar치 el contenido del directorio actual al ejecutar el contenedor, para ello tenemos que modificar el fichero que se encuentra en ''/etc/apache2/conf-available/docker-php.conf'' dentro del contenedor. Lo m치s sencillo ser치 copiar el fichero con la configuraci칩n original, modificarlo, copiar el fichero modificado y recargar la configuraci칩n del apache. Supongamos que el contenedor se llama ''hlcdam''

1- Copiamos el fichero del contenedor al directorio actual
''docker cp hlcdam:/etc/apache2/conf-available/docker-php.conf .''

2- Modificamos el fichero
La parte que nos interesa es la que tiene un ''Options -Indexes'', que hay que cambiarlo por:
''Options Indexes''

3- Volvemos a copiarlo dentro del contenedor
''docker cp docker-php.conf hlcdam:/etc/apache2/conf-available/docker-php.conf''

4- Recargamos el apache del contenedor
''docker exec hlcdam service apache2 reload''

**Nota**: s칩lo aparecen los ficheros y directorios que apache pueda leer. 
Los directorios tendr치n que tener permisos de ''r'' y ''x''. Para cambiar los permisos de todos los directorios bajo el directorio actual podemos ejecutar lo siguiente: ''for i in */; do chmod a+rx "$i" ; done''
Con ''-R'' lo haremos recursivo.


===== Servidor web integrado =====

Si tenemos PHP instalado localmente en nuestra m치quina, podemos usar el servidor web que incluye con:
''php -S localhost:8000 -t .''

Este es un servidor pensado para ser usado para pruebas r치pidas y demostraciones (Apache o Nginx son mejores), s칩lo debe ser usado para desarrollo y no est치 recomendado para producci칩n. Por defecto s칩lo permite accesos desde la propia m치quina. Habr칤a que usar ''0.0.0.0'' como direcci칩n para que se pueda acceder desde una m치quina remota.

Si queremos usar este servidor integrado desde nuestro propio contenedor, podemos usar esta receta
'''
docker run -d -it -v "$PWD":/root --name phpservintegrado -p80:80 ubuntu:22.04 /bin/bash
docker attach phpservintegrado
apt update && apt install php8.1
php -S 0.0.0.0:80 -t /root
'''



====== Insertar c칩digo PHP en HTML ======

Directamente podemos escribir c칩digo dentro de un fichero HTML con extensi칩n PHP. Basta incluirlo entre las etiquetas ''<?php'' y ''?>''.
'''
<?php
$numero = 20;
$palabra = "hola";
print_r(get_defined_vars());
?>
'''


===== Mostrar informaci칩n por la consola =====

Hay dos maneras de mostrar informaci칩n de una manera c칩moda. La primera es a trav칠s de la propia consola del navegador y la segunda a trav칠s de la consola del contenedor.

==== Usando la consola del navegador ====
Basta con ejecutar donde lo necesitemos un trozo de c칩digo javascript que escriba en la consola:
''echo("<script>console.log('PHP: Hola caracola')</script>");''

==== Usando la consola en el servidor ====
Para que sea el servidor el que nos muestre el mensaje, podemos usar la funci칩n ''error_log()''. Por ejemplo:
''error_log("Hola caracola");''

El problema es que si queremos ver esa informaci칩n 칰nicamente tendremos que filtrar la informaci칩n que obtengamos (por defecto todo lo que se registra en Apache pasa al fichero de logs). Suponiendo que el contenedor se llame ''hlcdam'', podemos hacerlo as칤:
''docker logs hlcdam | grep php:notice''




====== Variables ======


Las variables se declaran sin tipo, son din치micas y su nombre comienza por ''$''. Por ejemplo:
'''
$a = "Hola"
$a = 5;
'''


Para ver el valor de todas las variables creadas se puede usar lo siguiente:
''print_r(get_defined_vars());''

Para ver el valor de una variable en PHP junto con su tipo se puede usar la funci칩n ''var_dump( variable )''.

Para eliminar una variable (y por tanto liberar memoria) se puede usar ''unset( $a );''
Esto puede que s칩lo tenga sentido hacerlo si hablamos de liberar objetos grandes o arrays.


===== Aclaraciones sobre el nombre de las variables =====

==== Distingue may칰sculas de min칰sculas... a veces ====

PHP es semi //case-sensitive//, en algunos casos distingue may칰sculas de min칰sculas y en otros no lo hace.

Por ejemplo las palabras reservadas del lenguaje (como ''if'', ''while'' o ''for'') se pueden escribir de cualquier forma, sin embargo se distingue entre may칰sculas y min칰sculas en los nombres de variables, pero no en el de las funciones.

==== Palabras reservadas ====

Como las variables comienzan por ''$'', podemos tener variables que se llamen como las palabras reservadas del lenguaje ''$while''.

==== Nombres correctos ====

Los nombres de las variables pueden contener n칰meros, pero no empezar por un n칰mero.
Pueden comenzar y terminar por ''_'',
No pueden tener espacios en el nombre.
Las variables pueden contener caracteres unicode como acentos, e침es o cedillas.

쯈u칠 nombres de variables son correctos? Pi칠nsalo primero y luego realiza alguna prueba donde lo confirmes.
'''
$$
$游눨
$function
$___estado_
$23alumno
$alumno23
$?php
$php?
$PinG칲inO
$.nombre
$nombre.
$nom.bre
$p-h

'''

==== Scope (치mbito) de las variables ====

Las variables pueden tener 3 치mbitos distintos:
	* **global**
	* **local**
	* **static**


=== Local ===

Una variable **local** est치 definida en un bloque y s칩lo existe dentro de ese bloque de c칩digo. Por ejemplo, una funci칩n creada en un bucle ''for'' como 칤ndice, una variable creada dentro de una funci칩n, etc.

**Nota**: No es exactamente igual que Javascript. Por ejemplo: 쯈u칠 imprimir치 este c칩digo?
'''
$a = 2;
{
	$a = 5;
	$b = 'Hola';
}
echo $a, $b
'''


**Soluci칩n**: Imprimir치 ''5Hola''


=== Global ===

Una variable **global** est치 disponible en cualquier parte del c칩digo, se declaran en el //main// del c칩digo (la parte general). Pero debemos indicar que estamos accediendo a ella con la palabra reservada ''global'', por ejemplo:
'''
function saludo(){
	global $a;        //indicamos que vamos a usar la vble global $a
	return "Hola " . $a;
}

$a = 'Javier';
'''


**Importante**: se le puede cambiar el valor a la variable global dentro del c칩digo de una funci칩n.


=== Static ===

Una variable declarada como ''static'' en una funci칩n permanecer치 en memoria y no se eliminar치 al terminar la ejecuci칩n de la funci칩n. S칩lo se le asignar치 el valor inicial la primera vez que se ejecute la funci칩n.

'''
function contar(){
	static $num = 0;
	$num++;
	echo '<p>', $num,'</p>';
}

contar(); //imprime 1
contar(); //imprime 2
contar(); //imprime 3
'''



===== Cadenas de caracteres =====

Las cadenas de caracteres que vayamos a usar tal cual, sin modificar, deber칤amos declararlas usando las comillas simples. Al no tener que ser interpretado ser치 m치s eficiente y por tanto deber칤a ser nuestra opci칩n por defecto.
Sin embargo, cuando indicamos la cadena de caracteres con comillas dobles el int칠rprete de PHP tratar치 de interpretar el contenido de la cadena de caracteres. 

Por ejemplo:
'''
$a = 'Javier Mancera';
echo "<p>$a</p>";  //Javier Mancera
echo '<p>$a</p>';  //$a
'''



El caracter de escape es la contrabarra \.
''$james_brown = 'This is a Man\'s World!';''

Las comillas dobles pueden contener caracteres de escape que significan cosas diferentes: ''\n'', ''\t'', ''\\'', ''\$'', ''\r'', ''\"'', ...

Adem치s, podemos usar **plantillas** al estilo de Javascript (pero no igual, cambia el orden de ''${}'' y no puede contener expresiones (como una suma), s칩lo variables). Esta opci칩n es preferible a la de poner directamente el nombre de la variable (en el segundo ejemplo se ve que sin las llaves habr칤a ambig칲edad sobre si queremos la variable ''$animalPreferido'' o la ''$animalPreferidos'').

Ejemplo 1:
'''
$nombre = 'Javier';
echo "\n\t Mi nombre es {$nombre}!";
'''

Ejemplo 2:
'''
$animalPreferido = 'perro';
echo "Me gustan los {$animalPreferido}s";
'''


Se pueden concatenar cadenas usando los operadores ''.'' o ''.='' 
Sin embargo, es m치s r치pido y eficiente usar comillas dobles y plantillas literales.
'''
$a =  'a';       //a
$a =  'a' . 'b'; //ab
$a .= 'c';       //abc
'''


Una cadena de caracteres tiene una limitaci칩n de tama침o de 2GB como m치ximo.

Una cadena de caracteres puede abarcar varias l칤neas:
'''
echo 'Esto es perfectamente
valido y no dar치
ning칰n tipo de problemas';
'''



===== Constantes =====

Las constantes siempre tienen 치mbito glocal. 
''define( 'FIRST_CONSTANT', 'first' );''

Se declaran sin usar el ''$'' y con el nombre en may칰sculas.

===== Conversi칩n de tipos (Casting) =====

PHP tratar치 de convertir los tipos de las variables autom치ticamente. Por ejemplo:
'''
$a = 5; //contiene un entero
$b = 2;
$a = $a/$b; // $a contiene 2.5, un float
'''


Para hacer la conversi칩n de manera expl칤cita podemos usar:
	* string
	* float
	* int
	* bool
	* array
	* object

'''
$diez = 10;
$conv = (string) $diez;
var_dump( $conv );
'''


Un ejemplo algo m치s elaborado:
'''
$numTexto = '10';
$num = (int) $numTexto; //contiene 10
$precio = 15.5;
$num = (int) $precio;
echo $num; //Imprime 15
'''



===== Ejercicios: =====

**Ejercicio 1:** Escribe un programa que muestre tu nombre y tu edad por pantalla. Utiliza c칩digo PHP y HTML. Cada dato debe ir en una l칤nea diferente.
Modifica el ejercicio para que tu nombre y edad se almacenen en una variable al principio y haz que se muestre por pantalla la edad que tendr치s el curso siguiente, usa plantillas literales para mostrar los mensajes.

**Ejercicio 2:** Crea un conversor de euros a d칩lares. La cantidad de euros a convertir debe estar almacenada en una variable y la tasa de cambio entre las monedas en una constante.

**Ejercicio 3:** Escribe un programa que utilice las variables ''$x'', ''$y'' y ''$z''. Asignales los valores 313, 979 y 123 respectivamente. A continuaci칩n, muestra por pantalla el valor de cada variable, la suma de las tres variables, la resta, la multiplicaci칩n y finalmente la divisi칩n de ''$x'' entre ''$y''. 
Vuelve a calcular la divisi칩n de ''$x'' entre ''$y'', pero esta vez realiza un casting a entero al resultado antes de mostrarlo por pantalla. 쯈u칠 n칰mero se muestra?
Vuelve a mostrar el resultado de la divisi칩n, pero haz que en esta ocasi칩n s칩lo se muestren dos valores decimales usando la funci칩n ''number_format''. Redondea valores? 쯉e muestran decimales si el valor que se usa con la funci칩n ''number_format'' es  un n칰mero entero? 쮸lguna diferencia con la funci칩n ''round''?
쮺u치nto vale la media de los tres valores?

**Ejercicio 4:** Crea un conversor de semanas a segundos, el n칰mero de semanas se almacenar치 en una variable. Haz que se muestren el valor de todas las variables creadas en el c칩digo.

**Ejercicio 5:** Dado este c칩digo 쯤u칠 ocurrir치? 쯥e mostrar치 algo por pantalla y si es as칤 qu칠 ser치?
'''
$a = 7;
{
	$a = 8.2;
}
$A = 2;
eCHo (int) $a;
echo $a/0;
'''

**Ejercicio 6:** Crea un programa que contenga 3 variables: ''$nombre'', ''$apellido1'' y ''$apellido2''. 
Crea una cuarta variable ''$nombreCompleto'' que contenga la uni칩n del nombre y los dos apellidos.
Haz que se muestre por pantalla el nombre junto con los dos apellidos.
Haz que se muestre por pantalla primero los dos apellidos y separado por una coma el nombre.
Ejemplo:
'''
Javier Mancera Fern치ndez
Mancera Fern치ndez, Javier
'''


**Ejercicio 7:** Crea un conversor de binario a decimal de 4 bits.
Por ejemplo:
'''
$bin = 1100;
...   // <-- completa el c칩digo necesario
echo "$bin en base 2 es $dec en base 10"; //1011 en base 2 es 12 en base 10
'''



== ocultar ==

Soluci칩n del conversor a binario:
'''
$a = 1010;
$b0 = (int) $a%10;
$b1 = ((int) $a/10)%10;
$b2 = ((int) $a/100)%10;
$b3 = ((int) $a/1000)%10;

$dec = $b0 + $b1*2 + $b2*4 + $b3*(2**3);
echo "$bin es $dec";
'''


== finocultar ==
